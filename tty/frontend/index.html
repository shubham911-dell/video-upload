<!DOCTYPE html>
<html>
<head>
  <title>YouTube</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 1200px; margin: 0 auto; padding: 20px; }
    .upload-container { background: #f5f5f5; padding: 20px; border-radius: 8px; margin-bottom: 30px; }
    .gallery { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
    .video-card { border: 1px solid #ddd; border-radius: 8px; overflow: hidden; }
    .video-card video { width: 100%; background: #000; }
    .video-info { padding: 15px; }
    .video-info h3 { margin-top: 0; }
    .progress-bar { height: 5px; background: #eee; margin-top: 10px; }
    .progress { height: 100%; background: #4CAF50; width: 0%; }
  </style>
</head>
<body>
  <h1>Shubham ko website ma video halne thau</h1>
  
  <div class="upload-container">
    <h2>video hala</h2>
    <input type="file" id="videoInput" accept="video/*">
    <button onclick="uploadVideo()">yo click garepaxi video upload hunxa.</button>
    <div class="progress-bar"><div class="progress" id="uploadProgress"></div></div>
  </div>

  <div class="gallery" id="videoGallery">
    <!-- Videos will be loaded here -->
  </div>

  <script>
    // Load videos when page loads
    document.addEventListener('DOMContentLoaded', loadVideos);

    async function loadVideos() {
      try {
        const response = await fetch('/videos');
        const videos = await response.json();
        displayVideos(videos);
      } catch (error) {
        console.error('Error loading videos:', error);
      }
    }

    function displayVideos(videos) {
      const gallery = document.getElementById('videoGallery');
      gallery.innerHTML = videos.map(video => `
        <div class="video-card">
          <video controls src="${video.cloudinaryUrl || video.path}"></video>
          <div class="video-info">
            <h3>${video.filename}</h3>
            <p>${new Date(video.uploadDate).toLocaleString()}</p>
            <p>${formatFileSize(video.size)} â€¢ ${formatDuration(video.duration)}</p>
          </div>
        </div>
      `).join('');
    }

    async function uploadVideo() {
      const fileInput = document.getElementById('videoInput');
      if (!fileInput.files.length) return alert('Please select a video file');

      const file = fileInput.files[0];
      const formData = new FormData();
      formData.append('video', file);

      try {
        const progressBar = document.getElementById('uploadProgress');
        progressBar.style.width = '0%';

        const response = await fetch('/upload', {
          method: 'POST',
          body: formData,
        });

        if (response.ok) {
          progressBar.style.width = '100%';
          alert('Video uploaded successfully!');
          loadVideos(); // Refresh the gallery
          fileInput.value = ''; // Clear the file input
        } else {
          throw new Error('Upload failed');
        }
      } catch (error) {
        console.error('Upload error:', error);
        alert('Error uploading video: ' + error.message);
      }
    }

    function formatFileSize(bytes) {
      if (bytes === 0) return '0 Bytes';
      const k = 1024;
      const sizes = ['Bytes', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }

    function formatDuration(seconds) {
      if (!seconds) return '';
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    }
  </script>
</body>
</html>
